import \'dart:io\';\n\nimport \'package:flutter/material.dart\';\nimport \'package:image_picker/image_picker.dart\';\n\nclass PlantDiseasePage extends StatefulWidget {\n  const PlantDiseasePage({super.key});\n\n  @override\n  State<PlantDiseasePage> createState() => _PlantDiseasePageState();\n}\n\nclass _PlantDiseasePageState extends State<PlantDiseasePage> {\n  File? _image;\n  String? _disease;\n  bool _isLoading = false;\n\n  Future<void> _pickImage(ImageSource source) async {\n    final pickedFile = await ImagePicker().pickImage(source: source);\n    if (pickedFile != null) {\n      setState(() {\n        _image = File(pickedFile.path);\n        _disease = null; // Clear previous results\n      });\n    }\n  }\n\n  void _detectDisease() {\n    if (_image == null) return;\n\n    setState(() {\n      _isLoading = true;\n    });\n\n    // **Simulated AI Detection**\n    // In a real app, you would send _image to a backend API for analysis.\n    Future.delayed(const Duration(seconds: 2), () {\n      setState(() {\n        _disease = \'Leaf Blight\'; // Example disease\n        _isLoading = false;\n      });\n    });\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text(\'Plant Disease Detection\'),\n        backgroundColor: Colors.green,\n      ),\n      body: SingleChildScrollView(\n        padding: const EdgeInsets.all(16.0),\n        child: Column(\n          crossAxisAlignment: CrossAxisAlignment.stretch,\n          children: [\n            _buildImageSelectionCard(),\n            const SizedBox(height: 20),\n            if (_isLoading)\n              const Center(child: CircularProgressIndicator()),\n            if (_disease != null && !_isLoading) _buildResultCard(),\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildImageSelectionCard() {\n    return Card(\n      elevation: 5,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(15)),\n      child: Padding(\n        padding: const EdgeInsets.all(20.0),\n        child: Column(\n          children: [\n            const Text(\'Detect Plant Disease\',\n                style: TextStyle(fontSize: 22, fontWeight: FontWeight.bold)),\n            const SizedBox(height: 20),\n            if (_image != null)\n              ClipRRect(\n                borderRadius: BorderRadius.circular(10),\n                child: Image.file(_image!, height: 200, fit: BoxFit.cover),\n              )\n            else\n              const Icon(Icons.sick_outlined, size: 80, color: Colors.green),\n            const SizedBox(height: 20),\n            if (_image == null)\n              const Text(\n                \'Upload a clear picture of an affected plant leaf to get an instant diagnosis.\',\n                textAlign: TextAlign.center,\n                style: TextStyle(fontSize: 16, color: Colors.grey),\n              ),\n            const SizedBox(height: 20),\n            Row(\n              mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n              children: [\n                TextButton.icon(\n                  icon: const Icon(Icons.photo_library, color: Colors.green),\n                  label: const Text(\'Gallery\', style: TextStyle(color: Colors.green)),\n                  onPressed: () => _pickImage(ImageSource.gallery),\n                ),\n                TextButton.icon(\n                  icon: const Icon(Icons.camera_alt, color: Colors.green),\n                  label: const Text(\'Camera\', style: TextStyle(color: Colors.green)),\n                  onPressed: () => _pickImage(ImageSource.camera),\n                ),\n              ],\n            ),\n            if (_image != null)\ ...[\n              const SizedBox(height: 20),\n              ElevatedButton(\n                onPressed: _detectDisease,\n                style: ElevatedButton.styleFrom(\n                  backgroundColor: Colors.green,\n                  padding: const EdgeInsets.symmetric(horizontal: 40, vertical: 15),\n                  textStyle: const TextStyle(fontSize: 18),\n                ),\n                child: const Text(\'Detect Disease\'),\n              ),\n            ],\n          ],\n        ),\n      ),\n    );\n  }\n\n  Widget _buildResultCard() {\n    return Card(\n      elevation: 5,\n      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(15)),\n      color: Colors.red.shade50,\n      child: Padding(\n        padding: const EdgeInsets.all(20.0),\n        child: Column(\n          children: [\n            const Text(\'Diagnosis Result\',\n                style: TextStyle(fontSize: 22, fontWeight: FontWeight.bold, color: Colors.red)),\n            const SizedBox(height: 20),\n            Text(_disease!,\n                style: const TextStyle(fontSize: 28, fontWeight: FontWeight.bold, color: Colors.red)),\n            const SizedBox(height: 20),\n            const Text(\n              \'Recommended Action: Apply a fungicide containing copper or mancozeb. Remove and destroy infected leaves to prevent spread.\',\n              textAlign: TextAlign.center,\n              style: TextStyle(fontSize: 16),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n}\n